(this.webpackJsonpphasekeeper=this.webpackJsonpphasekeeper||[]).push([[0],{10:function(e,t,a){},15:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);a(10);var r=a(2),s=a.n(r),n=a(9),c=a.n(n),o=(a(15),a(3)),l=a(7),i=a(1),d="stored-game",u=[{goals:[{goalType:"set",successThreshold:3},{goalType:"set",successThreshold:3}]},{goals:[{goalType:"set",successThreshold:3},{goalType:"run",successThreshold:4}]},{goals:[{goalType:"set",successThreshold:4},{goalType:"run",successThreshold:4}]},{goals:[{goalType:"run",successThreshold:7}]},{goals:[{goalType:"run",successThreshold:8}]},{goals:[{goalType:"run",successThreshold:9}]},{goals:[{goalType:"set",successThreshold:4},{goalType:"set",successThreshold:4}]},{goals:[{goalType:"color-match",successThreshold:7}]},{goals:[{goalType:"set",successThreshold:5},{goalType:"set",successThreshold:2}]},{goals:[{goalType:"set",successThreshold:5},{goalType:"set",successThreshold:3}]}],j={addPlayer:function(e,t){if("addPlayer"!==t.type)return e;var a=e.players;return Object(i.a)(Object(i.a)({},e),{},{players:[].concat(Object(l.a)(a),[{completedPhase:0,lastCommittedScore:0,stagedScoreAdjustment:0,playerId:a.length,name:t.data.name}])})},adjustPhase:function(e,t){if("adjustPhase"!==t.type)return e;var a=e.players,r=t.data,s=r.adjustment,n=r.playerId,c=a.map((function(e){return e.playerId!==n?e:Object(i.a)(Object(i.a)({},e),{},{completedPhase:e.completedPhase+s})}));return Object(i.a)(Object(i.a)({},e),{},{players:c})},commitScores:function(e,t){if("commitScores"!==t.type)return e;var a=e.players,r=a.some((function(e){return e.completedPhase>=10})),s=a.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{lastCommittedScore:e.lastCommittedScore+e.stagedScoreAdjustment,stagedScoreAdjustment:0})}));return r?Object(i.a)(Object(i.a)({},e),{},{gameState:"complete",players:s}):Object(i.a)(Object(i.a)({},e),{},{isRoundInProgress:!0,players:s})},adjustStagedScoring:function(e,t){if("adjustStagedScoring"!==t.type)return e;var a=e.players,r=t.data,s=r.adjustment,n=r.playerId;return Object(i.a)(Object(i.a)({},e),{},{players:a.map((function(e){return e.playerId===n?Object(i.a)(Object(i.a)({},e),{},{stagedScoreAdjustment:e.stagedScoreAdjustment+s}):e}))})},discardStagedScoreAdustments:function(e,t){if("discardStagedScoreAdustments"!==t.type)return e;var a=e.players,r=t.data.playerId;return Object(i.a)(Object(i.a)({},e),{},{players:a.map((function(e){return e.playerId===r?Object(i.a)(Object(i.a)({},e),{},{stagedScoreAdjustment:0}):e}))})},endRound:function(e){return Object(i.a)(Object(i.a)({},e),{},{isRoundInProgress:!1})},removePlayer:function(e,t){if("removePlayer"!==t.type)return e;var a=e.players;return Object(i.a)(Object(i.a)({},e),{},{players:a.filter((function(e){return e.playerId!==t.data.playerId}))})},reset:function(e,t){return"reset"!==t.type?e:{gameState:"init",hasGameStarted:!1,isRoundInProgress:!1,players:e.players,phasesView:e.phasesView}},restoreSavedState:function(e,t){if("restoreSavedState"!==t.type)return e;var a=localStorage.getItem(d);return a?JSON.parse(a):e},saveGameState:function(e,t){return"saveGameState"!==t.type||localStorage.setItem(d,JSON.stringify(e)),e},clearSavedState:function(e,t){return"clearSavedState"!==t.type||localStorage.removeItem(d),e},start:function(e,t){if("start"!==t.type)return e;var a=e.players;return Object(i.a)(Object(i.a)({},e),{},{gameState:"active",hasGameStarted:!0,isRoundInProgress:!0,players:a.map((function(e){return Object(i.a)(Object(i.a)({},e),{},{completedPhase:0,lastCommittedScore:0,stagedScoreAdjustment:0})}))})}},p=function(e,t){var a=j[t.type];return a?a(e,t):e},h=a(0),b={gameState:"init",players:[],hasGameStarted:!1,isRoundInProgress:!1,phasesView:"active"},m=Object(r.createContext)([b,void 0]),y=function(e){var t=e.children,a=e.initialState,s=void 0===a?b:a,n=e.reducer,c=void 0===n?p:n,l=Object(r.useReducer)(c,s),i=Object(o.a)(l,2),d=i[0],u=function(e){return{addPlayer:function(t){return e({type:"addPlayer",data:{name:t}})},start:function(){return e({type:"start"})},endRound:function(){return e({type:"endRound"})},adjustPhase:function(t,a){return e({type:"adjustPhase",data:{playerId:t,adjustment:a}})},adjustStagedScoring:function(t,a){return e({type:"adjustStagedScoring",data:{playerId:t,adjustment:a}})},discardStagedScoreAdustments:function(t){return e({type:"discardStagedScoreAdustments",data:{playerId:t}})},commitScores:function(){return e({type:"commitScores"})},reset:function(){return e({type:"reset"})},removePlayer:function(t){return e({type:"removePlayer",data:{playerId:t}})},saveState:function(){return e({type:"saveGameState"})},clearSavedState:function(){return e({type:"clearSavedState"})},restoreSavedState:function(){return e({type:"restoreSavedState"})}}}(i[1]);return Object(h.jsx)(m.Provider,{value:[d,u],children:t})},O=function(){var e=Object(r.useContext)(m),t=Object(o.a)(e,2),a=t[0].players,s=t[1];if(Object(r.useEffect)((function(){null===s||void 0===s||s.clearSavedState()}),[s]),a.length<1)return Object(h.jsx)("div",{"data-testid":"error-view",children:Object(h.jsx)("h1",{children:"Whoops. Looks like we got here without any players... Where'd everybody go?"})});var n=a.sort((function(e,t){return e.completedPhase>t.completedPhase?-1:t.completedPhase>e.completedPhase?1:e.lastCommittedScore-t.lastCommittedScore})),c=n[0];return Object(h.jsxs)("div",{children:[Object(h.jsxs)("h1",{"data-testid":"text-congrats",children:["Congratulations ",c.name||"Player ".concat(c.playerId),"!"]}),n.map((function(e){return Object(h.jsxs)("div",{"data-testid":"text-player-outcome",children:[e.name||"Player ".concat(e.playerId)," completed Phase ",e.completedPhase," ","with ",e.lastCommittedScore," points."]},"player-outcome-".concat(e.playerId))})),Object(h.jsx)("button",{style:{marginTop:10},onClick:function(e){null===s||void 0===s||s.reset()},children:"Play again!"})]})},g=function(){var e=Object(r.useContext)(m),t=Object(o.a)(e,2),a=t[0].players,s=t[1],n=Object(r.useState)(""),c=Object(o.a)(n,2),l=c[0],i=c[1],d=a&&a.length>0;return Object(h.jsxs)("div",{className:"Roster-container",children:[Object(h.jsx)("div",{className:"Roster-heading",children:"Players:"}),d&&Object(h.jsx)("div",{className:"Roster-players",children:a.map((function(e){return Object(h.jsxs)("div",{className:"Roster-player",children:[e.name||e.playerId,Object(h.jsx)("span",{className:"Roster-remove",onClick:function(t){null===s||void 0===s||s.removePlayer(e.playerId)},children:"X"})]},"player-".concat(e.playerId))}))}),Object(h.jsx)("div",{children:Object(h.jsx)("input",{type:"text",placeholder:"new player",value:l,"aria-label":"Player Name",onChange:function(e){var t;i(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)},onKeyPress:function(e){"Enter"===e.key&&(null===s||void 0===s||s.addPlayer(l),i(""))}})})]})},f=function(){var e=Object(r.useContext)(m),t=Object(o.a)(e,2),a=t[0].players,s=t[1],n=a&&a.length>1,c=!!localStorage.getItem(d);return Object(h.jsxs)("div",{children:[Object(h.jsxs)("div",{className:"Game-setup-instruction",children:["Tired of pen and paper? Let Phasekeeper track your game of"," ",Object(h.jsx)("a",{href:"https://www.mattelgames.com/en-us/cards/phase-10",rel:"noreferrer",target:"_blank",children:"Phase 10"}),"!"]}),Object(h.jsx)("div",{className:"Game-setup-instruction",children:"To get started, let's add your players."}),Object(h.jsx)(g,{}),Object(h.jsx)("button",{disabled:!n,onClick:function(e){null===s||void 0===s||s.clearSavedState(),null===s||void 0===s||s.start()},children:"Let's play!"}),Object(h.jsx)("button",{disabled:!c,onClick:function(e){null===s||void 0===s||s.restoreSavedState()},children:"Resume"}),Object(h.jsx)("div",{className:"Game-setup-instruction",children:'Wish this site was an app you could use offline? Try "Add to Home Screen"!'}),Object(h.jsxs)("div",{className:"Game-setup-instruction",children:["For more details, see these instructions for"," ",Object(h.jsx)("a",{href:"https://support.google.com/chrome/answer/9658361?hl=en&co=GENIE.Platform%3DAndroid",target:"_blank",rel:"noreferrer",children:"Chrome"}),","," ",Object(h.jsx)("a",{href:"https://www.howtogeek.com/667910/how-to-add-a-website-to-your-iphone-or-ipad-home-screen/",target:"_blank",rel:"noreferrer",children:"Safari"}),", and"," ",Object(h.jsx)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps/Installable_PWAs",target:"_blank",rel:"noreferrer",children:"Firefox"}),"."]})]})},v=a(6),S=function(e){var t=e.phase,a=e.phaseIndex,r=e.players,s=e.phaseView,n=r&&r.length>0;if("active"===s&&!n)return null;var c=t.goals.reduce((function(e,t){var a="a ".concat(t.goalType," of ").concat(t.successThreshold);return e?e+" and ".concat(a):"".concat(a)}),"");return Object(h.jsxs)("div",{className:"PhaseCard-container",children:[Object(h.jsx)("span",{className:"RoundInProgress-phase-indicator",children:a+1}),Object(h.jsx)("div",{className:"PhaseCard-players",children:r.map((function(e){return Object(h.jsxs)("span",{className:"PhaseCard-player",children:[e.name||"Player ".concat(e.playerId)," (",e.lastCommittedScore,")"]},"PhaseCard-player-".concat(e.playerId))}))}),Object(h.jsx)("div",{className:"PhaseCard-goal",children:c})]})},x=function(){var e=Object(r.useContext)(m),t=Object(o.a)(e,2),a=t[0],s=a.players,n=a.phasesView,c=t[1],d=s.reduce((function(e,t){var a=t.completedPhase,r=[].concat(Object(l.a)(e[a]||[]),[t]);return Object(i.a)(Object(i.a)({},e),{},Object(v.a)({},a,r))}),{}),j=u.map((function(e,t){return Object(h.jsx)(S,{phase:e,phaseIndex:t,phaseView:n,players:d[t]},"phaseCard-".concat(t))}));return Object(h.jsxs)("div",{children:[j,Object(h.jsx)("button",{style:{marginTop:10},className:"action-button",onClick:function(e){null===c||void 0===c||c.endRound()},children:"Next Phase"})]})},P=function(e){var t=e.label,a=e.rangeValue,r=e.setRangeValueCb;return Object(h.jsxs)("div",{className:"ScoreCard-slider",children:[Object(h.jsx)("span",{children:t}),Object(h.jsxs)("div",{children:[Object(h.jsx)("input",{className:"ScoreCard-range",type:"range",min:"0",max:"10",step:"1",onChange:function(e){r(+e.target.value)},value:a}),Object(h.jsx)("span",{children:a})]})]})},C=function(e){var t=e.player,a=Object(r.useContext)(m),s=Object(o.a)(a,2)[1],n=Object(r.useState)(0),c=Object(o.a)(n,2),l=c[0],i=c[1],d=Object(r.useState)(0),u=Object(o.a)(d,2),j=u[0],p=u[1],b=Object(r.useState)(0),y=Object(o.a)(b,2),O=y[0],g=y[1],f=Object(r.useState)(0),v=Object(o.a)(f,2),S=v[0],x=v[1],C=Object(r.useState)(!1),T=Object(o.a)(C,2),I=T[0],w=T[1],k=t.name,N=t.playerId,R=t.stagedScoreAdjustment;Object(r.useEffect)((function(){var e=5*l+10*j+25*O+50*S;null===s||void 0===s||s.adjustStagedScoring(N,e-R)}),[l,j,O,S]);var A="phase-complete-".concat(N);return Object(h.jsxs)("div",{className:"ScoreCard-container",children:[Object(h.jsxs)("div",{className:"ScoreCard-player",children:[Object(h.jsx)("span",{children:k||"Player ".concat(N)}),Object(h.jsxs)("div",{children:[Object(h.jsx)("label",{htmlFor:A,children:"Completed Phase?"}),Object(h.jsx)("input",{id:A,type:"checkbox",checked:I,onChange:function(e){var t=e.target.checked;null===s||void 0===s||s.adjustPhase(N,t?1:-1),w(t)}})]})]},"ScoreCard-player-".concat(N)),Object(h.jsx)(P,{label:"Cards 1-9",rangeValue:l,setRangeValueCb:function(e){i(e)}}),Object(h.jsx)(P,{label:"Cards 10-12",rangeValue:j,setRangeValueCb:function(e){p(e)}}),Object(h.jsx)(P,{label:"Skips",rangeValue:O,setRangeValueCb:function(e){g(e)}}),Object(h.jsx)(P,{label:"Wilds",rangeValue:S,setRangeValueCb:function(e){x(e)}}),Object(h.jsxs)("span",{children:["Round score: ",R]})]})},T=function(){var e=Object(r.useContext)(m),t=Object(o.a)(e,2),a=t[0].players,s=t[1];return Object(h.jsxs)("div",{className:"ScoreCards-container",children:[a.map((function(e){return Object(h.jsx)(C,{player:e},"ScoreCard-".concat(e.playerId))})),Object(h.jsx)("button",{style:{marginTop:10},onClick:function(e){null===s||void 0===s||s.commitScores(),null===s||void 0===s||s.saveState()},children:"Continue"})]})},I=function(){var e=Object(r.useContext)(m),t=Object(o.a)(e,1)[0],a=function(){switch(t.gameState){case"init":return Object(h.jsx)(f,{});case"active":return t.isRoundInProgress?Object(h.jsx)(x,{}):Object(h.jsx)(T,{});case"complete":return Object(h.jsx)(O,{})}}();return Object(h.jsx)("div",{className:"Game-view",children:a})};var w=function(){return Object(h.jsxs)("div",{className:"App",children:[Object(h.jsx)("header",{className:"App-header",children:Object(h.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(h.jsx)("img",{className:"Phasekeeper-logo",src:"/logo512-transparent.png",alt:"Phasekeeper logo"}),Object(h.jsx)("h4",{children:"Phasekeeper"})]})}),Object(h.jsx)("div",{className:"App-main",children:Object(h.jsx)(y,{children:Object(h.jsx)(I,{})})}),Object(h.jsxs)("footer",{className:"App-footer",children:[Object(h.jsx)("div",{className:"App-footer-install-hint",children:'Consider using "Add to Home Screen" to install this free application instead of bookmarking the site in your browser!'}),Object(h.jsxs)("div",{className:"App-report-issues-info",children:["To review known issues or report new ones, come see us on"," ",Object(h.jsx)("a",{href:"https://github.com/druttka/phasekeeper/issues",rel:"noreferrer",target:"_blank",children:"GitHub"}),"!"]})]})]})},k=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,18)).then((function(t){var a=t.getCLS,r=t.getFID,s=t.getFCP,n=t.getLCP,c=t.getTTFB;a(e),r(e),s(e),n(e),c(e)}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(h.jsx)(s.a.StrictMode,{children:Object(h.jsx)(w,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),k()}},[[17,1,2]]]);
//# sourceMappingURL=main.e3ecb492.chunk.js.map